<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gqhmt.funds.architect.account.mapper.read.FundSequenceReadMapper">
	<sql id="fieldSql">
	</sql>
	<sql id="whereSql">
	</sql>
	<sql id="otherSql">
		<choose>
		<when test="orderStr != null">
			order by ${orderStr}
		</when>
		<otherwise>
		</otherwise>
		</choose>
	</sql>
	<select id="selectAccountSequenceList" parameterType="java.util.Map" resultType="com.gqhmt.funds.architect.account.bean.FundAccountSequenceBean">
		SELECT 
		b.id id,
		b.account_no accountNo,
		a.CUSTOMER_NAME	customerName,
		b.account_type accountType,
		b.busi_type busiType,
		b.cust_id custId,
		c.actionType actionType,
		c.amount amount,
		c.CREATE_TIME creatTime,
		c.thirdparty_type thirdPartyType
		FROM `t_gq_customer_info` a ,`t_gq_fund_account` b ,t_gq_fund_sequence c 
		where a.ID=b.user_id AND c.ACCOUNT_ID=b.id and  b.id=#{id}
        <if test="customerName != null and customerName != ''">
        and a.CUSTOMER_NAME like concat('%',#{customerName},'%') 
        </if>
        <if test="accountType != null and accountType != ''">
        and b.account_type=#{accountType}
        </if>
        <if test="busiType != null and busiType != ''">
        and b.busi_type=#{busiType}
        </if>
        <if test="actionType != null and actionType != ''">
        and c.actionType=#{actionType}
        </if>
		<choose>
             <when test="startDate == null or startDate == '' and endDate==null or endDate==''">
               AND 1=1
              </when>
                <when test="startDate != null and startDate != '' and endDate==null or endDate=='' ">
                AND c.create_time BETWEEN #{startDate} AND SYSDATE()
              </when>
              <when test="startDate != null and startDate != '' and endDate!=null and endDate!=''">
               AND c.create_time BETWEEN #{startDate} AND #{endDate}
              </when>
              <when test="startDate == null or startDate == '' and endDate!=null and endDate!=''">
               AND c.create_time &lt; #{endDate}
              </when>
         </choose>
	</select>
</mapper>
