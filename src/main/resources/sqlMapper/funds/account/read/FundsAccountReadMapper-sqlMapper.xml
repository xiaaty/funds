<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gqhmt.funds.architect.account.mapper.read.FundAccountReadMapper">

	<!-- 账户管理 -->
	<select id="findAcountList" parameterType="java.util.Map" resultType="com.gqhmt.funds.architect.account.bean.FundAccountCustomerBean">
		 SELECT 
		b.id id,
		a.CUSTOMER_NAME	customerName,
		a.SEX sex,
		a.CERT_NO certNo,
		a.MOBILE_PHONE mobilePhone,
		b.account_type accountType,
		b.busi_type busiType,
		b.cust_id custId,
		b.account_no accountNo,
		b.amount amount,
		b.CREATE_TIME creatTime,
		b.freeze_amount freezeAmount,
		b.has_Third_Account hasThirdAccount
		FROM `t_gq_customer_info` a RIGHT JOIN `t_gq_fund_account` b ON a.ID=b.user_id
		<where>
		 <if test="custId &gt; 100 ">
			and b.cust_id &gt; 100 and b.busi_type=0
        </if>
		 <if test="custId &lt; 100 ">
			and b.cust_id  &lt; 100 and b.busi_type=0
        </if>
        <if test="customerName != null and customerName != ''">
        and a.CUSTOMER_NAME like concat('%',#{customerName},'%') 
        </if>
			<choose>
                <when test="creatTime == null or creatTime == '' and modifyTime==null ">
               AND 1=1
              </when>
                <when test="creatTime != null and creatTime != '' and modifyTime==null or modifyTime=='' ">
                AND b.create_time BETWEEN #{creatTime} AND SYSDATE()
              </when>
              <when test="creatTime != null and creatTime != '' and modifyTime!=null and modifyTime!=''">
               AND b.create_time BETWEEN #{creatTime} AND #{modifyTime}
              </when>
              <when test="creatTime == null or creatTime == '' and modifyTime!=null and modifyTime!=''">
               AND b.create_time &lt; #{modifyTime}
              </when>
           </choose>
		</where>        
	</select>
</mapper>
